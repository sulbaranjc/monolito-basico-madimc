# üè• MEDIMIC - Sistema de Gesti√≥n M√©dica de IMC

## üìã Descripci√≥n del Proyecto

**MEDIMIC** es un sistema monol√≠tico educativo para la gesti√≥n de pacientes y c√°lculo de √çndice de Masa Corporal (IMC), desarrollado con **FastAPI** y **Jinja2**. Este proyecto est√° dise√±ado como una herramienta de aprendizaje que demuestra las mejores pr√°cticas de desarrollo web moderno, arquitectura de componentes y dise√±o responsivo.

### üéØ Objetivos Educativos

- **Arquitectura Monol√≠tica**: Comprensi√≥n de aplicaciones web completas en un solo repositorio
- **Patrones de Dise√±o**: Implementaci√≥n de MVC, componentes reutilizables y separaci√≥n de responsabilidades
- **CSS Moderno**: Flexbox, CSS Grid, responsive design y metodolog√≠as de organizaci√≥n
- **Validaci√≥n de Datos**: Pydantic para validaci√≥n robusta del lado servidor
- **UX/UI Moderno**: Modales personalizados, animaciones y accesibilidad

## üèóÔ∏è Arquitectura del Sistema

### üìÇ Estructura del Proyecto

```
medimic/
‚îú‚îÄ‚îÄ app/                          # üêç Aplicaci√≥n principal
‚îÇ   ‚îú‚îÄ‚îÄ main.py                   # üöÄ Punto de entrada FastAPI
‚îÇ   ‚îú‚îÄ‚îÄ models/                   # üìä Modelos de datos Pydantic
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ patient.py           # üë§ Modelo de paciente con validaciones
‚îÇ   ‚îú‚îÄ‚îÄ routers/                  # üõ§Ô∏è Rutas organizadas por m√≥dulos
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ patients.py          # üè• CRUD completo de pacientes
‚îÇ   ‚îú‚îÄ‚îÄ data/                     # üíæ Datos seed y persistencia
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ patients_seed.py     # üå± Datos de ejemplo para desarrollo
‚îÇ   ‚îú‚îÄ‚îÄ templates/                # üé® Templates Jinja2
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ patients_list.html   # üìã Vista de listado
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ patients_create.html # ‚ûï Vista de creaci√≥n
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ patients_edit.html   # ‚úèÔ∏è Vista de edici√≥n
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ components/          # üß© Componentes reutilizables
‚îÇ   ‚îÇ       ‚îú‚îÄ‚îÄ header.html      # üîù Cabecera com√∫n
‚îÇ   ‚îÇ       ‚îî‚îÄ‚îÄ footer.html      # üîª Pie de p√°gina com√∫n
‚îÇ   ‚îî‚îÄ‚îÄ static/                   # üìÅ Recursos est√°ticos
‚îÇ       ‚îú‚îÄ‚îÄ css/                  # üé® Hojas de estilo
‚îÇ       ‚îÇ   ‚îú‚îÄ‚îÄ main.css         # üè† Estilos globales
‚îÇ       ‚îÇ   ‚îú‚îÄ‚îÄ main_commented.css # üìñ Versi√≥n educativa comentada
‚îÇ       ‚îÇ   ‚îú‚îÄ‚îÄ patients_list.css # üìã Estilos espec√≠ficos de listado
‚îÇ       ‚îÇ   ‚îî‚îÄ‚îÄ patients_create.css # üìù Estilos espec√≠ficos de formularios
‚îÇ       ‚îú‚îÄ‚îÄ js/                   # ‚ö° Scripts JavaScript
‚îÇ       ‚îÇ   ‚îú‚îÄ‚îÄ patients_list.js # üóëÔ∏è Modal de confirmaci√≥n personalizado
‚îÇ       ‚îÇ   ‚îú‚îÄ‚îÄ patients_edit.js # ‚úèÔ∏è Funcionalidades de edici√≥n
‚îÇ       ‚îÇ   ‚îî‚îÄ‚îÄ patients_create.js # ‚ûï Validaci√≥n en tiempo real
‚îÇ       ‚îî‚îÄ‚îÄ img/                  # üñºÔ∏è Im√°genes y logos
‚îú‚îÄ‚îÄ requirements.txt              # üì¶ Dependencias Python
‚îú‚îÄ‚îÄ CSS_GUIDE.md                 # üìö Gu√≠a educativa de CSS
‚îî‚îÄ‚îÄ .vscode/                     # ‚öôÔ∏è Configuraci√≥n de desarrollo
    ‚îî‚îÄ‚îÄ settings.json            # üîß Prettier y formateo autom√°tico
```

## üöÄ Tecnolog√≠as Implementadas

### üêç Backend (Python)

- **[FastAPI 0.120.0](https://fastapi.tiangolo.com/)**: Framework web moderno y r√°pido
- **[Pydantic](https://pydantic.dev/)**: Validaci√≥n de datos con Python types
- **[Jinja2](https://jinja.palletsprojects.com/)**: Motor de templates para renderizado server-side
- **[Uvicorn](https://www.uvicorn.org/)**: Servidor ASGI de alta performance

### üé® Frontend

- **HTML5 Sem√°ntico**: Estructura accesible y SEO-friendly
- **CSS3 Moderno**: Flexbox, CSS Grid, Custom Properties
- **JavaScript Vanilla**: Sin frameworks, enfoque en fundamentos
- **Responsive Design**: Mobile-first approach

### üõ†Ô∏è Herramientas de Desarrollo

- **[Prettier](https://prettier.io/)**: Formateo autom√°tico de c√≥digo
- **VS Code**: Configuraci√≥n optimizada para desarrollo
- **Cache-busting**: Estrategias para desarrollo sin cach√©

### üìä Dependencias Extendidas

El proyecto incluye un stack completo de librer√≠as para funcionalidades avanzadas:

- **Cient√≠ficas**: `numpy`, `pandas`, `torch` (preparado para ML/AI)
- **Datos**: `mysql-connector-python`, `openpyxl` (persistencia y export)
- **Validaci√≥n**: `email-validator`, `python-multipart`
- **Audio/AI**: `openai-whisper` (preparado para funcionalidades de voz)

## üìä Modelo de Datos

### üë§ Entidad Paciente

```python
class PatientBase(BaseModel):
    first_name: str = Field(..., min_length=1, max_length=60)
    last_name: str = Field(..., min_length=1, max_length=60)
    date_of_birth: date
    sex_at_birth: Literal["Masculino", "Femenino", "Otro"]
    gender_identity: Optional[str] = Field(None, max_length=30)
    email: Optional[EmailStr] = None
    phone: Optional[str] = Field(None, pattern=r"^[0-9+\-() ]{7,20}$")
    notes: Optional[str] = Field(None, max_length=500)
    consent_data_processing: bool = True
```

### üßÆ C√°lculos Autom√°ticos

- **IMC**: Peso (kg) / (Altura (m))¬≤
- **Categor√≠a IMC**: Bajo peso, Normal, Sobrepeso, Obesidad
- **Edad**: Calculada autom√°ticamente desde fecha de nacimiento
- **Datos Computados**: Nombre completo, estado adulto, contactabilidad

## üé® Sistema de Dise√±o CSS

### üèóÔ∏è Arquitectura CSS Modular

1. **`main.css`** - Estilos globales y componentes base
2. **`patients_list.css`** - Estilos espec√≠ficos para tablas
3. **`patients_create.css`** - Sistema de formularios
4. **`main_commented.css`** - Versi√≥n educativa con documentaci√≥n

### üé≠ Patrones de Dise√±o Implementados

#### üîÑ Sticky Footer Pattern

```css
body {
  display: flex;
  flex-direction: column;
  min-height: 100vh;
}
main {
  flex: 1 0 auto;
}
.site-footer {
  margin-top: auto;
}
```

#### üìä CSS Grid para Formularios

```css
.grid-form {
  display: grid;
  grid-template-columns: 1fr 1fr;
  gap: 14px;
}
@media (max-width: 820px) {
  .grid-form {
    grid-template-columns: 1fr;
  }
}
```

#### üé® Sistema de Botones Sem√°nticos

- **`.btn-primary`**: Acciones principales (azul)
- **`.btn-secondary`**: Acciones secundarias (gris)
- **`.btn-danger`**: Acciones destructivas (rojo)

### üì± Responsive Design

- **Breakpoint principal**: 820px
- **Mobile-first approach**
- **Flexbox** para componentes unidimensionales
- **CSS Grid** para layouts bidimensionales

## ‚ö° Funcionalidades JavaScript

### üóëÔ∏è Sistema de Modal Personalizado

Reemplaza `window.confirm()` nativo con un modal elegante:

```javascript
function confirmDelete(formEl) {
  const name = formEl?.dataset?.displayName || "este paciente";
  const modal = createDeleteModal(name);
  // ... implementaci√≥n completa con animaciones y accesibilidad
}
```

**Caracter√≠sticas**:

- Animaciones CSS con transiciones suaves
- M√∫ltiples formas de cerrar (click overlay, ESC, botones)
- Accesibilidad con focus management
- Escape HTML para seguridad

### üîß Cache-busting Din√°mico

```javascript
// Carga JS con timestamp para evitar cach√© en desarrollo
const s = document.createElement("script");
s.src =
  "{{ url_for('static', path='js/patients_list.js') }}" + "?v=" + Date.now();
```

## üè• Funcionalidades del Sistema

### üìã Gesti√≥n de Pacientes (CRUD Completo)

#### ‚ûï **Crear Paciente**

- Formulario con validaci√≥n server-side
- Campos obligatorios y opcionales
- Validaci√≥n de email y tel√©fono con regex
- C√°lculo autom√°tico de IMC
- Consentimiento para tratamiento de datos

#### üìä **Listar Pacientes**

- Tabla responsive con datos esenciales
- Ordenamiento alfab√©tico por apellido
- Display de IMC y categor√≠a
- Botones de acci√≥n (Modificar/Eliminar)
- Estados para datos faltantes (valores "‚Äî")

#### ‚úèÔ∏è **Editar Paciente**

- Pre-carga de datos existentes
- Rec√°lculo de IMC al modificar peso/altura
- Mantenimiento del estado de consentimiento
- Validaci√≥n consistente con creaci√≥n

#### üóëÔ∏è **Eliminar Paciente**

- Modal de confirmaci√≥n personalizado
- Prevenci√≥n de eliminaci√≥n accidental
- Feedback visual claro
- Acciones irreversibles claramente marcadas

### üßÆ C√°lculo de IMC

#### F√≥rmulas Implementadas

```python
def _calc_bmi(weight_kg: float, height_cm: float) -> float:
    h = height_cm / 100.0
    return round(weight_kg / (h * h), 2)

def _bmi_category(bmi: float) -> str:
    if bmi < 18.5: return "bajo peso"
    if bmi < 25.0: return "normal"
    if bmi < 30.0: return "sobrepeso"
    return "obesidad"
```

#### Caracter√≠sticas

- C√°lculo autom√°tico al crear/editar
- Categorizaci√≥n seg√∫n est√°ndares OMS
- Timestamp de √∫ltima medici√≥n
- Manejo de casos sin datos suficientes

### ‚úÖ Sistema de Validaci√≥n

#### Server-side (Pydantic)

- Validaci√≥n de tipos de datos
- Longitud de campos
- Formato de email
- Patr√≥n de tel√©fono
- Fechas v√°lidas

#### Traducci√≥n de Mensajes

```python
traducciones = {
    "String should have at least 1 character": "El texto debe tener al menos 1 car√°cter.",
    "Input should be a valid email address": "Debe ingresar un correo electr√≥nico v√°lido.",
    # ... m√°s traducciones
}
```

## üõ†Ô∏è Instalaci√≥n y Configuraci√≥n

### üìã Prerrequisitos

- **Python 3.9+**
- **pip** (gestor de paquetes Python)
- **Git** (opcional, para clonar el repositorio)

### üöÄ Instalaci√≥n Paso a Paso

1. **Clonar el repositorio**:

```bash
git clone <repository-url>
cd monolito-basico-medimc
```

2. **Crear entorno virtual**:

```bash
python -m venv .venv
```

3. **Activar entorno virtual**:

```bash
# Windows
.venv\Scripts\activate

# Linux/Mac
source .venv/bin/activate
```

4. **Instalar dependencias**:

```bash
pip install -r requirements.txt
```

### ‚ñ∂Ô∏è Ejecuci√≥n del Proyecto

#### Desarrollo

```bash
uvicorn app.main:app --reload --host 127.0.0.1 --port 8000
```

#### Producci√≥n

```bash
uvicorn app.main:app --host 0.0.0.0 --port 8000
```

### üåê Acceso a la Aplicaci√≥n

- **URL principal**: http://127.0.0.1:8000
- **Lista de pacientes**: http://127.0.0.1:8000/patients
- **Crear paciente**: http://127.0.0.1:8000/patients/create
- **API Docs**: http://127.0.0.1:8000/docs (Swagger UI autom√°tico)
- **Health Check**: http://127.0.0.1:8000/health

## üë• Uso del Sistema

### üìã Flujo de Trabajo T√≠pico

1. **Acceder al sistema** ‚Üí Redirecci√≥n autom√°tica a lista de pacientes
2. **Ver pacientes existentes** ‚Üí 3 pacientes seed precargados
3. **Crear nuevo paciente** ‚Üí Formulario con validaci√≥n
4. **Editar datos** ‚Üí Modificaci√≥n con rec√°lculo de IMC
5. **Eliminar paciente** ‚Üí Confirmaci√≥n con modal personalizado

### üéØ Casos de Uso Espec√≠ficos

#### ‚ûï Registro de Paciente Nuevo

1. Click en "Agregar paciente"
2. Llenar campos obligatorios (nombre, apellido, fecha nacimiento, sexo, peso, altura)
3. Campos opcionales (email, tel√©fono, notas)
4. Aceptar consentimiento de datos
5. Sistema calcula IMC autom√°ticamente
6. Redirecci√≥n a lista actualizada

#### üìä Consulta de IMC

- El sistema muestra IMC calculado en la tabla
- Categor√≠a autom√°tica (bajo peso/normal/sobrepeso/obesidad)
- Timestamp de √∫ltima medici√≥n
- Valores "‚Äî" para datos incompletos

#### ‚úèÔ∏è Actualizaci√≥n de Datos

1. Click en "Modificar" en la fila del paciente
2. Formulario pre-poblado con datos actuales
3. Modificar campos necesarios
4. Sistema recalcula IMC si cambia peso/altura
5. Validaci√≥n y guardado

## üìö Recursos Educativos

### üìñ Documentaci√≥n Incluida

- **`CSS_GUIDE.md`**: Gu√≠a completa del sistema CSS con ejercicios
- **`main_commented.css`**: CSS educativo con comentarios detallados
- **C√≥digo comentado**: Explicaciones t√©cnicas en cada archivo

### üéì Conceptos Ense√±ados

#### üé® Frontend

- **Flexbox vs CSS Grid**: Cu√°ndo usar cada uno
- **Responsive Design**: Mobile-first con breakpoints estrat√©gicos
- **Accesibilidad**: Focus states, ARIA, navegaci√≥n por teclado
- **Animaciones CSS**: Transiciones suaves y micro-interacciones

#### üêç Backend

- **FastAPI**: Decoradores, dependencias, validaci√≥n autom√°tica
- **Pydantic**: Modelos de datos, validaci√≥n, serializaci√≥n
- **Jinja2**: Templates, herencia, componentes
- **Arquitectura**: Separaci√≥n de responsabilidades, modularidad

#### üìä Patrones de Dise√±o

- **MVC**: Modelo-Vista-Controlador en web apps
- **Component Architecture**: Reutilizaci√≥n y mantenibilidad
- **Form Handling**: Validaci√≥n, estado, UX
- **State Management**: Persistencia en memoria, ciclo de vida

## üîß Configuraci√≥n de Desarrollo

### üé® Prettier (Formateo Autom√°tico)

Configuraci√≥n en `.prettierrc`:

```json
{
  "tabWidth": 2,
  "useTabs": false,
  "semi": true,
  "singleQuote": false,
  "printWidth": 80,
  "overrides": [
    {
      "files": "*.css",
      "options": { "printWidth": 100 }
    }
  ]
}
```

### ‚öôÔ∏è VS Code

Settings en `.vscode/settings.json`:

```json
{
  "editor.formatOnSave": true,
  "editor.defaultFormatter": "esbenp.prettier-vscode",
  "[css]": {
    "editor.defaultFormatter": "esbenp.prettier-vscode"
  }
}
```

### üîÑ Cache-busting para Desarrollo

- CSS: `?v={{ range(1000000) | random }}`
- JS: Timestamp din√°mico con `Date.now()`

## üéØ Ejercicios Sugeridos

### üî∞ Nivel B√°sico

1. **Modificar colores del sistema**:

   - Cambiar la paleta de colores corporativa
   - Crear un tema dark mode

2. **Agregar campos al modelo**:

   - Campo "direcci√≥n"
   - Campo "n√∫mero de historia cl√≠nica"

3. **Mejorar validaciones**:
   - Validar que la fecha de nacimiento no sea futura
   - Agregar validaci√≥n de peso/altura m√≠nimos

### üîµ Nivel Intermedio

1. **Implementar b√∫squeda**:

   - Buscador por nombre o email
   - Filtros por categor√≠a de IMC

2. **Agregar exportaci√≥n**:

   - Export a CSV
   - Report de estad√≠sticas

3. **Mejorar UX**:
   - Loading states
   - Notificaciones toast
   - Breadcrumbs

### üî¥ Nivel Avanzado

1. **Persistencia real**:

   - Integrar base de datos SQLite
   - Migrations con Alembic

2. **API REST completa**:

   - Endpoints JSON separados
   - Documentaci√≥n OpenAPI extendida

3. **Funcionalidades avanzadas**:
   - Hist√≥rico de IMC con gr√°ficos
   - Sistema de usuarios y autenticaci√≥n
   - Upload de im√°genes/documentos

## ü§ù Contribuci√≥n

### üìù Gu√≠as de Estilo

- **Python**: Seguir PEP 8
- **HTML**: Sem√°ntico y accesible
- **CSS**: Metodolog√≠a BEM-inspired
- **JavaScript**: ESLint standard

### üîÄ Flujo de Desarrollo

1. Fork del repositorio
2. Crear branch feature/bugfix
3. Implementar cambios con tests
4. Documentar nuevas funcionalidades
5. Pull request con descripci√≥n detallada

## üìÑ Licencia

Este proyecto est√° dise√±ado con fines educativos. Consultar con el instructor para uso comercial.

## üë®‚Äçüè´ Autor

**Ing. Juan Carlos Sulbaran**  
_Monolito FastAPI + Jinja2 ‚Äî MVP educativo_

---

## üîó Enlaces √ötiles

- [FastAPI Documentation](https://fastapi.tiangolo.com/)
- [Pydantic Documentation](https://pydantic.dev/)
- [Jinja2 Documentation](https://jinja.palletsprojects.com/)
- [CSS Grid Guide](https://css-tricks.com/snippets/css/complete-guide-grid/)
- [Flexbox Guide](https://css-tricks.com/snippets/css/a-guide-to-flexbox/)

---

_üìö Este README es parte del sistema educativo y se actualiza continuamente con mejoras pedag√≥gicas._
