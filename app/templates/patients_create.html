<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />

  <title>MEDIMIC — Crear paciente</title>

  <!-- CSS global -->
  <link rel="stylesheet" href="{{ url_for('static', path='css/main.css') }}">
  
  <!-- CSS específico de esta vista -->
  <link rel="stylesheet" href="{{ url_for('static', path='css/patients_create.css') }}">
</head>
<body>
  <!-- Componente Header -->
  {% include "components/header.html" %}

  <main class="container">
    <div class="form-page">
      <h2>Crear paciente</h2>

      {# Bloque resumen de errores (opcional) #}
      {% if errors_list and errors_list|length %}
        <div class="alert alert-error">
          <strong>Errores del formulario:</strong>
          <ul>
            {% for e in errors_list %}
              <li>{{ e }}</li>
            {% endfor %}
          </ul>
        </div>
      {% endif %}

      <div class="card">
        <form action="/patients/create" method="post" novalidate class="grid-form">
          <label>
            <span>Nombre</span>
            <input name="first_name" required value="{{ form_data.first_name or '' }}" />
            {% if errors.first_name %}<small class="field-error">{{ errors.first_name|join(', ') }}</small>{% endif %}
          </label>

          <label>
            <span>Apellido</span>
            <input name="last_name" required value="{{ form_data.last_name or '' }}" />
            {% if errors.last_name %}<small class="field-error">{{ errors.last_name|join(', ') }}</small>{% endif %}
          </label>

          <label>
            <span>Fecha de nacimiento</span>
            <input type="date" name="date_of_birth" required value="{{ form_data.date_of_birth or '' }}" />
            {% if errors.date_of_birth %}<small class="field-error">{{ errors.date_of_birth|join(', ') }}</small>{% endif %}
          </label>

          <label>
            <span>Sexo al nacer</span>
            <select name="sex_at_birth" required>
              {% set sx = form_data.sex_at_birth or '' %}
              <option value="" disabled {{ '' == sx and 'selected' or '' }}>Selecciona…</option>
              <option value="Masculino" {{ 'Masculino' == sx and 'selected' or '' }}>Masculino</option>
              <option value="Femenino"  {{ 'Femenino'  == sx and 'selected' or '' }}>Femenino</option>
              <option value="Otro"      {{ 'Otro'      == sx and 'selected' or '' }}>Otro</option>
            </select>
            {% if errors.sex_at_birth %}<small class="field-error">{{ errors.sex_at_birth|join(', ') }}</small>{% endif %}
          </label>

          <label>
            <span>Correo electrónico</span>
            <input type="email" name="email" placeholder="nombre@ejemplo.com" value="{{ form_data.email or '' }}" />
            {% if errors.email %}<small class="field-error">{{ errors.email|join(', ') }}</small>{% endif %}
          </label>

          <label>
            <span>Teléfono</span>
            <input name="phone" placeholder="+34 600 000 000" value="{{ form_data.phone or '' }}" />
            {% if errors.phone %}<small class="field-error">{{ errors.phone|join(', ') }}</small>{% endif %}
          </label>

          <label>
            <span>Altura (cm)</span>
            <input
              type="number"
              name="height_cm"
              step="0.1"
              min="50"
              max="250"
              placeholder="Ej.: 174"
              value="{{ form_data.height_cm or '' }}"
              required
            />
          </label>

          <label>
            <span>Peso (kg)</span>
            <input
              type="number"
              name="weight_kg"
              step="0.1"
              min="10"
              max="300"
              placeholder="Ej.: 82.5"
              value="{{ form_data.weight_kg or '' }}"
              required
            />
          </label>

          <label class="full checkbox">
            <input type="checkbox" name="consent_data_processing" {{ form_data.consent_data_processing and 'checked' or '' }}>
            <span>Acepto el consentimiento para el tratamiento de mis datos personales.</span>
            {% if errors.consent_data_processing %}<small class="field-error">{{ errors.consent_data_processing|join(', ') }}</small>{% endif %}
          </label>

          <div class="actions full">
            <button type="submit" class="btn-primary">Registrar</button>
            <a href="/patients" class="btn-secondary">Cancelar</a>
          </div>
        </form>
      </div>
    </div>
  </main>

  <!-- Componente Footer -->
  {% include "components/footer.html" %}

  <!-- JS por vista -->
  <script src="{{ url_for('static', path='js/patients_create.js') }}" defer></script>
</body>
</html>
